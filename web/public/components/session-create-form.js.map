{"version":3,"file":"session-create-form.js","sourceRoot":"","sources":["../../src/client/components/session-create-form.ts"],"names":[],"mappings":"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","sourcesContent":["import { LitElement, html } from 'lit';\nimport { customElement, property, state } from 'lit/decorators.js';\nimport './file-browser.js';\n\nexport interface SessionCreateData {\n  command: string[];\n  workingDir: string;\n}\n\n@customElement('session-create-form')\nexport class SessionCreateForm extends LitElement {\n  // Disable shadow DOM to use Tailwind\n  createRenderRoot() {\n    return this;\n  }\n\n  @property({ type: String }) workingDir = '~/';\n  @property({ type: String }) command = '';\n  @property({ type: Boolean }) disabled = false;\n\n  @state() private isCreating = false;\n  @state() private showFileBrowser = false;\n\n  private handleWorkingDirChange(e: Event) {\n    const input = e.target as HTMLInputElement;\n    this.workingDir = input.value;\n    this.dispatchEvent(new CustomEvent('working-dir-change', {\n      detail: this.workingDir\n    }));\n  }\n\n  private handleCommandChange(e: Event) {\n    const input = e.target as HTMLInputElement;\n    this.command = input.value;\n  }\n\n  private handleBrowse() {\n    this.showFileBrowser = true;\n  }\n\n  private handleDirectorySelected(e: CustomEvent) {\n    this.workingDir = e.detail;\n    this.showFileBrowser = false;\n  }\n\n  private handleBrowserCancel() {\n    this.showFileBrowser = false;\n  }\n\n  private async handleCreate() {\n    if (!this.workingDir.trim() || !this.command.trim()) {\n      this.dispatchEvent(new CustomEvent('error', {\n        detail: 'Please fill in both working directory and command'\n      }));\n      return;\n    }\n\n    this.isCreating = true;\n\n    const sessionData: SessionCreateData = {\n      command: this.parseCommand(this.command.trim()),\n      workingDir: this.workingDir.trim()\n    };\n\n    try {\n      const response = await fetch('/api/sessions', {\n        method: 'POST',\n        headers: { 'Content-Type': 'application/json' },\n        body: JSON.stringify(sessionData)\n      });\n\n      if (response.ok) {\n        const result = await response.json();\n        this.command = ''; // Clear command on success\n        this.dispatchEvent(new CustomEvent('session-created', {\n          detail: result\n        }));\n      } else {\n        const error = await response.json();\n        this.dispatchEvent(new CustomEvent('error', {\n          detail: `Failed to create session: ${error.error}`\n        }));\n      }\n    } catch (error) {\n      console.error('Error creating session:', error);\n      this.dispatchEvent(new CustomEvent('error', {\n        detail: 'Failed to create session'\n      }));\n    } finally {\n      this.isCreating = false;\n    }\n  }\n\n  private parseCommand(commandStr: string): string[] {\n    // Simple command parsing - split by spaces but respect quotes\n    const args: string[] = [];\n    let current = '';\n    let inQuotes = false;\n    let quoteChar = '';\n\n    for (let i = 0; i < commandStr.length; i++) {\n      const char = commandStr[i];\n      \n      if ((char === '\"' || char === \"'\") && !inQuotes) {\n        inQuotes = true;\n        quoteChar = char;\n      } else if (char === quoteChar && inQuotes) {\n        inQuotes = false;\n        quoteChar = '';\n      } else if (char === ' ' && !inQuotes) {\n        if (current) {\n          args.push(current);\n          current = '';\n        }\n      } else {\n        current += char;\n      }\n    }\n    \n    if (current) {\n      args.push(current);\n    }\n    \n    return args;\n  }\n\n  render() {\n    return html`\n      <div class=\"border border-vs-accent font-mono text-sm p-4 m-4 rounded\">\n        <div class=\"text-vs-assistant text-sm mb-4\">Create New Session</div>\n        \n        <div class=\"mb-4\">\n          <div class=\"text-vs-muted mb-2\">Working Directory:</div>\n          <div class=\"flex gap-4\">\n            <input\n              type=\"text\"\n              class=\"flex-1 bg-vs-bg text-vs-text border border-vs-border outline-none font-mono px-4 py-2\"\n              .value=${this.workingDir}\n              @input=${this.handleWorkingDirChange}\n              placeholder=\"~/\"\n              ?disabled=${this.disabled || this.isCreating}\n            />\n            <button \n              class=\"bg-vs-function text-vs-bg hover:bg-vs-highlight font-mono px-4 py-2 border-none\"\n              @click=${this.handleBrowse}\n              ?disabled=${this.disabled || this.isCreating}\n            >\n              browse\n            </button>\n          </div>\n        </div>\n\n        <div class=\"mb-4\">\n          <div class=\"text-vs-muted mb-2\">Command:</div>\n          <input\n            type=\"text\"\n            class=\"w-full bg-vs-bg text-vs-text border border-vs-border outline-none font-mono px-4 py-2\"\n            .value=${this.command}\n            @input=${this.handleCommandChange}\n            @keydown=${(e: KeyboardEvent) => e.key === 'Enter' && this.handleCreate()}\n            placeholder=\"zsh\"\n            ?disabled=${this.disabled || this.isCreating}\n          />\n        </div>\n\n        <button \n          class=\"bg-vs-user text-vs-text hover:bg-vs-accent font-mono px-4 py-2 border-none\"\n          @click=${this.handleCreate}\n          ?disabled=${this.disabled || this.isCreating || !this.workingDir.trim() || !this.command.trim()}\n        >\n          ${this.isCreating ? 'creating...' : 'create'}\n        </button>\n      </div>\n      \n      <file-browser\n        .visible=${this.showFileBrowser}\n        .currentPath=${this.workingDir}\n        @directory-selected=${this.handleDirectorySelected}\n        @browser-cancel=${this.handleBrowserCancel}\n      ></file-browser>\n    `;\n  }\n}"]}